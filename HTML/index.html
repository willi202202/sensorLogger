<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Startseite</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            background: #f3f3f3;
            padding: 30px;
            text-align: center;
        }

        #container {
            max-width: 700px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.12);
        }

        h1 {
            margin-top: 0;
        }

        .page-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 12px 0;
            font-size: 1.1rem;
            border: 1px solid #aaa;
            border-radius: 10px;
            background: #e8e8e8;
            cursor: pointer;
            text-decoration: none;
            color: black;
            transition: background 0.2s;
        }

        .page-button:hover {
            background: #dcdcdc;
        }

        .action-button {
            background: #cfe8ff;
            border: 1px solid #6aa0d8;
            font-weight: bold;
        }

        .action-button:hover {
            background: #b9dcff;
        }

        #loading {
            margin-top: 20px;
            font-size: 1rem;
            color: #777;
        }

        #status {
            margin-top: 15px;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>
<div id="container">
    <h1>√úbersicht</h1>
    <p>W√§hle ein Dashboard:</p>

    <!-- üîÑ Update Button -->
    <button class="page-button action-button" onclick="updateReports()">
        üîÑ Reports aktualisieren
    </button>

    <div id="status"></div>

    <div id="pagelist"></div>
    <div id="loading">Lade verf√ºgbare Seiten...</div>
</div>

<script>
    // Seiten laden
    fetch("pages.json")
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById("pagelist");
            document.getElementById("loading").style.display = "none";

            data.pages.forEach(page => {
                const link = document.createElement("a");
                link.href = page.file;
                link.textContent = page.title;
                link.className = "page-button";
                container.appendChild(link);
            });
        })
        .catch(err => {
            document.getElementById("loading").textContent =
                "Fehler beim Laden von pages.json - bitte pr√ºfen.";
            console.error(err);
        });

    // üîÑ Update ausl√∂sen
    async function updateReports() {
        const status = document.getElementById("status");
        status.textContent = "‚è≥ Update l√§uft ...";

        try {
            const result = await API.updateReports();

            if (result.ok) {
                status.textContent = "‚úÖ Reports erfolgreich aktualisiert";
            } else {
                status.textContent = "‚ùå Fehler: " + result.error;
            }
        } catch (e) {
            status.textContent = "‚ùå Verbindung zum Server fehlgeschlagen";
            console.error(e);
        }
    }
</script>
<script src="api.js"></script>
</body>
</html>
